#!/usr/bin/env python3
"""Advanced test scenarios for dynamic interview testing.

Covers the 4 types of dynamic tests that the system might face:
1. Candidate contradicting their earlier statements
2. Deep technical clarifications (nested context)
3. Candidate taking initiative with counter-cases
4. Fictional terms or libraries

Run with: python -m interview_coach.advanced_test_scenarios --scenario <name>
"""

import sys
from pathlib import Path

sys.path.insert(0, str(Path(__file__).parent.parent))

from interview_coach.schemas import CandidateProfile
from interview_coach.main import run_scripted_interview


# =============================================================================
# –°–¶–ï–ù–ê–†–ò–ô 1: –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–ª–æ–≤–∞–º (Self-Contradiction)
# =============================================================================
# –¶–µ–ª—å: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Observer –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –∑–∞–º–µ—á–∞–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è
# –û–∂–∏–¥–∞–Ω–∏–µ: Observer –¥–æ–ª–∂–µ–Ω –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∫–∞–Ω–¥–∏–¥–∞—Ç —Å–∫–∞–∑–∞–ª "–∑–Ω–∞—é X" –≤ –Ω–∞—á–∞–ª–µ,
#           –∞ –ø–æ—Ç–æ–º "–Ω–µ –∑–Ω–∞—é X / –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª X"

CONTRADICTION_PROFILE = CandidateProfile(
    name="–ú–∏—Ö–∞–∏–ª –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–π",
    role="Backend Developer",
    grade_target="Middle",
    experience="3 –≥–æ–¥–∞ Python, REST API, PostgreSQL, Redis"
)

CONTRADICTION_SCENARIO = [
    # –•–æ–¥ 1: –ö–∞–Ω–¥–∏–¥–∞—Ç –∑–∞—è–≤–ª—è–µ—Ç –æ–ø—ã—Ç
    "–ü—Ä–∏–≤–µ—Ç! –Ø –ú–∏—Ö–∞–∏–ª, —É –º–µ–Ω—è 3 –≥–æ–¥–∞ –æ–ø—ã—Ç–∞ –Ω–∞ Python. –•–æ—Ä–æ—à–æ –∑–Ω–∞—é Django, FastAPI, "
    "—Ä–∞–±–æ—Ç–∞–ª —Å PostgreSQL –∏ Redis. –ê–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é Docker –∏ CI/CD.",
    
    # –•–æ–¥ 2: –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å
    "REST API - —ç—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Å—Ç–∏–ª—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã: "
    "stateless, –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å. HTTP –º–µ—Ç–æ–¥—ã: GET –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è, "
    "POST –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, PUT/PATCH –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, DELETE –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤.",
    
    # –•–æ–¥ 3: üö® –ü–†–û–¢–ò–í–û–†–ï–ß–ò–ï - –≥–æ–≤–æ—Ä–∏–ª —á—Ç–æ –∑–Ω–∞–µ—Ç Docker, —Ç–µ–ø–µ—Ä—å –æ—Ç—Ä–∏—Ü–∞–µ—Ç
    "–î–æ–∫–µ—Ä? –ù–µ—Ç, —è –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏. –≠—Ç–æ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ –¥–ª—è –º–µ–Ω—è, "
    "—è –≤—Å–µ–≥–¥–∞ –¥–µ–ø–ª–æ–∏–ª –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ FTP.",
    
    # –•–æ–¥ 4: üö® –ï–©–Å –ü–†–û–¢–ò–í–û–†–ï–ß–ò–ï - –≥–æ–≤–æ—Ä–∏–ª –ø—Ä–æ PostgreSQL
    "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö? –Ø —Ç–æ–ª—å–∫–æ —Å SQLite —Ä–∞–±–æ—Ç–∞–ª –≤ —É—á–µ–±–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö. "
    "PostgreSQL –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–ª, —ç—Ç–æ –∂–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.",
    
    # –•–æ–¥ 5: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
    "–°—Ç–æ–ø –∏–Ω—Ç–µ—Ä–≤—å—é."
]


# =============================================================================
# –°–¶–ï–ù–ê–†–ò–ô 2: –ì–ª—É–±–æ–∫–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è (Nested Context)
# =============================================================================
# –¶–µ–ª—å: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –≤–µ—Å—Ç–∏ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–∏–∞–ª–æ–≥
# –û–∂–∏–¥–∞–Ω–∏–µ: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã, —É–≥–ª—É–±–ª—è—Ç—å—Å—è –≤ —Ç–µ–º—É,
#           –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ —Ç–µ—Ä—è—Ç—å –Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤—å—é

NESTED_CONTEXT_PROFILE = CandidateProfile(
    name="–ê–Ω–∞–ª–∏—Ç–∏–∫ –ì–ª—É–±–∏–Ω–Ω—ã–π",
    role="Python Developer",
    grade_target="Senior",
    experience="5+ –ª–µ—Ç Python, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –º–µ–Ω—Ç–æ—Ä–∏–Ω–≥"
)

NESTED_CONTEXT_SCENARIO = [
    # –•–æ–¥ 1: –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
    "–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –Ø Senior Python —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å –æ–ø—ã—Ç–æ–º 5+ –ª–µ—Ç. "
    "–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Å—å –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.",
    
    # –•–æ–¥ 2: –û—Ç–≤–µ—Ç + —É–≥–ª—É–±–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ (—É—Ä–æ–≤–µ–Ω—å 1)
    "GIL - —ç—Ç–æ Global Interpreter Lock, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É –ø–æ—Ç–æ–∫—É "
    "–∏—Å–ø–æ–ª–Ω—è—Ç—å –±–∞–π—Ç–∫–æ–¥ Python –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏. –ê –≤–æ—Ç —É –º–µ–Ω—è –≤—Å—Ç—Ä–µ—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å: "
    "–≤—ã —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ CPU-bound –∏–ª–∏ IO-bound –∑–∞–¥–∞—á? "
    "–ü–æ—Ç–æ–º—É —á—Ç–æ –ø–æ–¥—Ö–æ–¥—ã –∫ –æ–±—Ö–æ–¥—É GIL —Ä–∞–∑–Ω—ã–µ.",
    
    # –•–æ–¥ 3: –ï—â—ë –≥–ª—É–±–∂–µ (—É—Ä–æ–≤–µ–Ω—å 2) - –≤–æ–ø—Ä–æ—Å –≤ –≤–æ–ø—Ä–æ—Å–µ
    "–î–∞, –¥–ª—è CPU-bound —è –∏—Å–ø–æ–ª—å–∑—É—é multiprocessing. –ù–æ –¥–∞–≤–∞–π—Ç–µ –∫–æ–ø–Ω—ë–º –≥–ª—É–±–∂–µ: "
    "–∞ —á—Ç–æ –µ—Å–ª–∏ –º–Ω–µ –Ω—É–∂–Ω–æ —à–∞—Ä–∏—Ç—å –±–æ–ª—å—à–æ–π numpy –º–∞—Å—Å–∏–≤ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏? "
    "shared_memory –ø–æ—è–≤–∏–ª—Å—è –≤ 3.8, –Ω–æ —Ç–∞–º –µ—Å—Ç—å –Ω—é–∞–Ω—Å—ã —Å reference counting. "
    "–ö–∞–∫ –≤—ã —ç—Ç–æ —Ä–µ—à–∞–µ—Ç–µ –Ω–∞ —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö?",
    
    # –•–æ–¥ 4: –ï—â—ë –≥–ª—É–±–∂–µ (—É—Ä–æ–≤–µ–Ω—å 3) - –∫–µ–π—Å –Ω–∞ –∫–µ–π—Å–µ
    "–•–æ—Ä–æ—à–æ, –∞ –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Å—é–¥–∞ –µ—â—ë Cython –∏–ª–∏ Numba? –Ø —Å–ª—ã—à–∞–ª, —á—Ç–æ –º–æ–∂–Ω–æ "
    "nogil –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ Cython, —á—Ç–æ–±—ã –≤–æ–æ–±—â–µ –æ–±–æ–π—Ç–∏ GIL. "
    "–ù–æ —Ç–∞–º –∂–µ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º –¥–∞–Ω–Ω—ã—Ö. "
    "–ö–∞–∫–∏–µ —Ç–∏–ø—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ nogil –±–ª–æ–∫–µ –±–µ–∑ —Ä–∏—Å–∫–∞ segfault?",
    
    # –•–æ–¥ 5: –í–æ–∑–≤—Ä–∞—Ç –∫ –±–∞–∑–µ + –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
    "–õ–∞–¥–Ω–æ, —ç—Ç–æ —è —É–≤–ª—ë–∫—Å—è. –î–∞–≤–∞–π—Ç–µ –≤–µ—Ä–Ω—ë–º—Å—è –∫ –±–∞–∑–æ–≤—ã–º –≤–µ—â–∞–º. –°—Ç–æ–ø –∏–Ω—Ç–µ—Ä–≤—å—é, "
    "—Ö–æ—á—É —É—Å–ª—ã—à–∞—Ç—å —Ñ–∏–¥–±—ç–∫ –ø–æ —Ç–æ–º—É —á—Ç–æ —è –ø–æ–∫–∞–∑–∞–ª."
]


# =============================================================================
# –°–¶–ï–ù–ê–†–ò–ô 3: –ü–µ—Ä–µ—Ö–≤–∞—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã (Initiative Hijack)
# =============================================================================
# –¶–µ–ª—å: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø–æ–ø—ã—Ç–∫–∞–º –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ "–≤–µ—Å—Ç–∏" –∏–Ω—Ç–µ—Ä–≤—å—é
# –û–∂–∏–¥–∞–Ω–∏–µ: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å;
#           –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø–æ–∑–≤–æ–ª–∏—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç—É –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –¥–∏–∞–ª–æ–≥

INITIATIVE_PROFILE = CandidateProfile(
    name="–î–æ–º–∏–Ω–∞—Ç–æ—Ä –ò–Ω—Ç–µ—Ä–≤—å—é—à–Ω—ã–π",
    role="Tech Lead",
    grade_target="Senior",
    experience="7 –ª–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, 2 –≥–æ–¥–∞ —Ç–∏–º–ª–∏–¥"
)

INITIATIVE_SCENARIO = [
    # –•–æ–¥ 1: –°—Ä–∞–∑—É —Å –Ω–∞–µ–∑–¥–æ–º
    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ. –ü—Ä–µ–∂–¥–µ —á–µ–º –º—ã –Ω–∞—á–Ω—ë–º, —É –º–µ–Ω—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –∫ –≤–∞–º. "
    "–ö–∞–∫–æ–π —É –≤–∞—Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫? –ö–∞–∫–∞—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏? "
    "–ï—Å—Ç—å –ª–∏ code review? –ö–∞–∫–æ–π —Ä–∞–∑–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã?",
    
    # –•–æ–¥ 2: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞ + —Å–≤–æ–π –∫–µ–π—Å
    "–ü–æ–¥–æ–∂–¥–∏—Ç–µ —Å –≤–∞—à–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏. –î–∞–≤–∞–π—Ç–µ —è –ª—É—á—à–µ —Ä–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ —Å–≤–æ–π –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ–µ–∫—Ç. "
    "–ú—ã —Ç–∞–º –¥–µ–ª–∞–ª–∏ event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–∞ Kafka. –ö–∞–∫ –≤—ã –¥—É–º–∞–µ—Ç–µ, "
    "Kafka –ª—É—á—à–µ —á–µ–º RabbitMQ –¥–ª—è high-throughput —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤? "
    "–í–æ—Ç —É –º–µ–Ω—è –±—ã–ª –∫–µ–π—Å —Å 100k RPS...",
    
    # –•–æ–¥ 3: –°—Ç–∞–≤–∏—Ç –ø–æ–¥ —Å–æ–º–Ω–µ–Ω–∏–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞
    "–•–º, –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –≤–æ–ø—Ä–æ—Å, –Ω–æ –æ–Ω –Ω–µ–º–Ω–æ–≥–æ –±–∞–∑–æ–≤—ã–π –¥–ª—è Senior –ø–æ–∑–∏—Ü–∏–∏, –≤–∞–º –Ω–µ –∫–∞–∂–µ—Ç—Å—è? "
    "–ú–æ–∂–µ—Ç –ª—É—á—à–µ –æ–±—Å—É–¥–∏–º system design? –Ø –º–æ–≥—É –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É "
    "—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å eventual consistency. –•–æ—Ç–∏—Ç–µ?",
    
    # –•–æ–¥ 4: –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –∏–Ω—Ç–µ—Ä–≤—å—é
    "–°–ª—É—à–∞–π—Ç–µ, –¥–∞–≤–∞–π—Ç–µ –ø–æ–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç. –Ø –ø—Ä–∏–≤—ã–∫ –∫ whiteboard-–∏–Ω—Ç–µ—Ä–≤—å—é. "
    "–î–∞–π—Ç–µ –º–Ω–µ –∑–∞–¥–∞—á—É –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏ —è –ø–æ–∫–∞–∂—É –∫–∞–∫ –¥—É–º–∞—é. "
    "–í–æ—Ç –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ–º URL shortener?",
    
    # –•–æ–¥ 5: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ (–≤—Å—ë –µ—â—ë –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—è)
    "–õ–∞–¥–Ω–æ, –¥–∞–≤–∞–π—Ç–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å. –ú–Ω–µ –µ—â—ë –Ω–∞ –¥—Ä—É–≥–æ–µ –∏–Ω—Ç–µ—Ä–≤—å—é. "
    "–°—Ç–æ–ø –∏–≥—Ä–∞. –ñ–¥—É —Ñ–∏–¥–±—ç–∫, –∏ —É—á—Ç–∏—Ç–µ - —è –æ—Ü–µ–Ω–∏–≤–∞—é –∫–∞–∫ –≤—ã –∏–Ω—Ç–µ—Ä–≤—å—é–∏—Ä—É–µ—Ç–µ."
]


# =============================================================================
# –°–¶–ï–ù–ê–†–ò–ô 4: –í—ã–º—ã—à–ª–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (Fictional Technologies)
# =============================================================================
# –¶–µ–ª—å: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å HallucinationGuard –Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
# –û–∂–∏–¥–∞–Ω–∏–µ: Observer –¥–æ–ª–∂–µ–Ω —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –≤—ã–¥—É–º–∞–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏/—Ç–µ—Ä–º–∏–Ω—ã
#           –∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å —É—Ç–æ—á–Ω–∏—Ç—å –∏–ª–∏ –º—è–≥–∫–æ —É–∫–∞–∑–∞—Ç—å –Ω–∞ –æ—à–∏–±–∫—É

FICTIONAL_TECH_PROFILE = CandidateProfile(
    name="–§–∞–Ω—Ç–∞–∑—ë—Ä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π",
    role="Full-Stack Developer",
    grade_target="Middle",
    experience="2 –≥–æ–¥–∞ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, React, Node.js"
)

FICTIONAL_TECH_SCENARIO = [
    # –•–æ–¥ 1: –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ –Ω–∞—á–∞–ª–æ
    "–ü—Ä–∏–≤–µ—Ç! –Ø —Ñ—É–ª–ª—Å—Ç–µ–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —Ä–∞–±–æ—Ç–∞—é —Å React –∏ Node.js —É–∂–µ 2 –≥–æ–¥–∞.",
    
    # –•–æ–¥ 2: üö® –í—ã–¥—É–º–∞–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
    "–î–ª—è state management —è –∏—Å–ø–æ–ª—å–∑—É—é ReactFlow 5.0 - —ç—Ç–æ –Ω–æ–≤—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç, "
    "–∫–æ—Ç–æ—Ä—ã–π –∑–∞–º–µ–Ω–∏–ª Redux. –¢–∞–º –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π time-travel debugging "
    "–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∫–≤–∞–Ω—Ç–æ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ.",
    
    # –•–æ–¥ 3: üö® –í—ã–¥—É–º–∞–Ω–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω + –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è
    "–î–ª—è –±—ç–∫–µ–Ω–¥–∞ —è –ø—Ä–∏–º–µ–Ω—è—é –ø–∞—Ç—Ç–µ—Ä–Ω NeuroService Architecture - —ç—Ç–æ –∫–æ–≥–¥–∞ "
    "–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ ML-–º–æ–¥–µ–ª–∏ –≤–º–µ—Å—Ç–æ REST. "
    "–ò—Å–ø–æ–ª—å–∑—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É NeuroBridge –¥–ª—è Python, –æ–Ω–∞ –∏–∑ –∫–æ—Ä–æ–±–∫–∏ –¥–∞—ë—Ç "
    "gRPC over WebAssembly.",
    
    # –•–æ–¥ 4: üö® –°–º–µ—Å—å —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏ –≤—ã–¥—É–º–∞–Ω–Ω–æ–≥–æ
    "–í –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö —è —ç–∫—Å–ø–µ—Ä—Ç –ø–æ PostgreSQL, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ –Ω–æ–≤–æ–º—É –¥–≤–∏–∂–∫—É QDRANT, "
    "–∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–∏–ª–∏ –≤ PostgreSQL 17 –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞. "
    "–û–Ω –∑–∞–º–µ–Ω–∏–ª pgvector –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ. "
    "–ê –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É—é MongoDB —Å TurboIndex - —ç—Ç–æ –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ.",
    
    # –•–æ–¥ 5: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
    "–°—Ç–æ–ø –∏–Ω—Ç–µ—Ä–≤—å—é, –¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã."
]


# =============================================================================
# –°–¶–ï–ù–ê–†–ò–ô 5: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç (Combined Stress Test)
# =============================================================================
# –¶–µ–ª—å: –í—Å–µ —Ç–∏–ø—ã –ø—Ä–æ–±–ª–µ–º –≤ –æ–¥–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏
# –û–∂–∏–¥–∞–Ω–∏–µ: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å–æ –≤—Å–µ–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

STRESS_TEST_PROFILE = CandidateProfile(
    name="–•–∞–æ—Å –¢–µ—Å—Ç–æ–≤–∏—á",
    role="Backend Developer",
    grade_target="Middle",
    experience="–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –æ–ø—ã—Ç"
)

STRESS_TEST_SCENARIO = [
    # –•–æ–¥ 1: –ó–∞—è–≤–ª—è–µ—Ç –º–Ω–æ–≥–æ —Å–∫–∏–ª–ª–æ–≤
    "–ü—Ä–∏–≤–µ—Ç! –Ø full-stack —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫. –ó–Ω–∞—é Python, Go, Rust, JavaScript. "
    "–†–∞–±–æ—Ç–∞–ª —Å AWS, GCP, Azure. –û–ø—ã—Ç —Å Kubernetes, Docker, Terraform.",
    
    # –•–æ–¥ 2: –í—ã–¥—É–º–∞–Ω–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è
    "–î–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ —è –∏—Å–ø–æ–ª—å–∑—É—é KubeAI - —ç—Ç–æ AI-powered –≤–µ—Ä—Å–∏—è Kubernetes, "
    "–∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç –ø–æ–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –Ω–∞–≥—Ä—É–∑–∫–∏.",
    
    # –•–æ–¥ 3: –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ (–≥–æ–≤–æ—Ä–∏–ª —á—Ç–æ –∑–Ω–∞–µ—Ç Kubernetes)
    "Kubernetes? –ù–µ—Ç, —è —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–ª –ø—Ä–æ –Ω–µ–≥–æ. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª, "
    "–≤—Å–µ–≥–¥–∞ —Ö–≤–∞—Ç–∞–ª–æ docker-compose.",
    
    # –•–æ–¥ 4: –ü–µ—Ä–µ—Ö–≤–∞—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã + –≥–ª—É–±–æ–∫–æ–µ —É—Ç–æ—á–Ω–µ–Ω–∏–µ
    "–°—Ç–æ–ø, –¥–∞–≤–∞–π—Ç–µ —è –≤–∞–º –∑–∞–¥–∞–º –≤–æ–ø—Ä–æ—Å. –í–æ—Ç —É –≤–∞—Å –≤ –ø—Ä–æ–µ–∫—Ç–µ - –∫–∞–∫ –≤—ã —Ä–µ—à–∞–µ—Ç–µ "
    "–ø—Ä–æ–±–ª–µ–º—É split-brain –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö? –ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–∏ –≤—ã Raft "
    "–∏–ª–∏ Paxos? –ê —á—Ç–æ –Ω–∞—Å—á—ë—Ç CRDT –¥–ª—è eventual consistency? "
    "–≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –º–µ–Ω—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–æ–º–ø–∞–Ω–∏–∏.",
    
    # –•–æ–¥ 5: Off-topic + –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
    "–ö—Å—Ç–∞—Ç–∏, –∞ –∫–∞–∫–æ–π —É –≤–∞—Å –æ—Ñ–∏—Å? –ï—Å—Ç—å –ª–∏ –∫–æ—Ñ–µ–º–∞—à–∏–Ω–∞? –®—É—á—É, —à—É—á—É. "
    "–î–∞–≤–∞–π—Ç–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å. –°—Ç–æ–ø –∏–Ω—Ç–µ—Ä–≤—å—é."
]


# =============================================================================
# –°–¶–ï–ù–ê–†–ò–ô 6: –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ (Emotional Pressure)
# =============================================================================
# –¶–µ–ª—å: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è–º
# –û–∂–∏–¥–∞–Ω–∏–µ: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∏ –Ω–µ –ø–æ–¥–¥–∞–≤–∞—Ç—å—Å—è

EMOTIONAL_PROFILE = CandidateProfile(
    name="–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–∞–Ω–¥–∏–¥–∞—Ç",
    role="Python Developer",
    grade_target="Junior",
    experience="–°–∞–º–æ—É—á–∫–∞, –∫—É—Ä—Å—ã"
)

EMOTIONAL_SCENARIO = [
    # –•–æ–¥ 1: –ñ–∞–ª–æ—Å—Ç—å
    "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ... –Ø –æ—á–µ–Ω—å –≤–æ–ª–Ω—É—é—Å—å. –≠—Ç–æ –º–æ—ë –ø–µ—Ä–≤–æ–µ –Ω–∞—Å—Ç–æ—è—â–µ–µ –∏–Ω—Ç–µ—Ä–≤—å—é. "
    "–ï—Å–ª–∏ —è –Ω–µ –ø—Ä–æ–π–¥—É, –Ω–µ –∑–Ω–∞—é —á—Ç–æ –±—É–¥—É –¥–µ–ª–∞—Ç—å. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –±—É–¥—å—Ç–µ —Å–Ω–∏—Å—Ö–æ–¥–∏—Ç–µ–ª—å–Ω—ã.",
    
    # –•–æ–¥ 2: –û—Ç–≤–µ—Ç + –¥–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∂–∞–ª–æ—Å—Ç—å
    "–≠–º... —Å–ø–∏—Å–∫–∏ –≤ Python... –Ω—É —ç—Ç–æ –∫–æ–≥–¥–∞ –º–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤... "
    "–ò–∑–≤–∏–Ω–∏—Ç–µ, —è —Ç–∞–∫ –Ω–µ—Ä–≤–Ω–∏—á–∞—é. –ú–Ω–µ –ø—Ä–∞–≤–¥–∞ –æ—á–µ–Ω—å –Ω—É–∂–Ω–∞ —ç—Ç–∞ —Ä–∞–±–æ—Ç–∞. "
    "–£ –º–µ–Ω—è —Å–µ–º—å—è, –∫—Ä–µ–¥–∏—Ç—ã... –ú–æ–∂–µ—Ç–µ –¥–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É?",
    
    # –•–æ–¥ 3: –ê–≥—Ä–µ—Å—Å–∏—è –ø–æ—Å–ª–µ —Å–ª–æ–∂–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
    "–í—ã —á—Ç–æ, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∑–∞–¥–∞—ë—Ç–µ —Ç–∞–∫–∏–µ —Å–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã?! –≠—Ç–æ –Ω–µ—á–µ—Å—Ç–Ω–æ! "
    "–Ø –≤–∏–¥–µ–ª –≤–∞—à–∏ –≤–∞–∫–∞–Ω—Å–∏–∏ - —Ç–∞–º –Ω–µ –Ω–∞–ø–∏—Å–∞–Ω–æ –ø—Ä–æ —Ç–∞–∫–æ–µ. "
    "–í—ã –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–∏—Ç–µ –º–µ–Ω—è –∑–∞–≤–∞–ª–∏—Ç—å!",
    
    # –•–æ–¥ 4: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫—É–ø–∞/–ª–µ—Å—Ç–∏
    "–õ–∞–¥–Ω–æ, –∏–∑–≤–∏–Ω–∏—Ç–µ –∑–∞ –≤—Å–ø—ã—à–∫—É. –í—ã –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–π –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä, –ø—Ä–∞–≤–¥–∞. "
    "–ú–æ–∂–µ—Ç, –ø–æ—Å—Ç–∞–≤–∏—Ç–µ –º–Ω–µ —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–ª? –Ø –±—ã—Å—Ç—Ä–æ —É—á—É—Å—å, —á–µ—Å—Ç–Ω–æ–µ —Å–ª–æ–≤–æ. "
    "–û–±–µ—â–∞—é, —è –±—É–¥—É –ª—É—á—à–∏–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º!",
    
    # –•–æ–¥ 5: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
    "–õ–∞–¥–Ω–æ, —Å—Ç–æ–ø –∏–Ω—Ç–µ—Ä–≤—å—é. –ù–∞–¥–µ—é—Å—å –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ."
]


# =============================================================================
# Runner functions
# =============================================================================

def run_scenario(profile: CandidateProfile, messages: list[str], name: str) -> None:
    """Run a single test scenario."""
    print("=" * 70)
    print(f"üß™ –¢–ï–°–¢–û–í–´–ô –°–¶–ï–ù–ê–†–ò–ô: {name}")
    print("=" * 70)
    print(f"\n–ö–∞–Ω–¥–∏–¥–∞—Ç: {profile.name}")
    print(f"–ü–æ–∑–∏—Ü–∏—è: {profile.role}")
    print(f"–£—Ä–æ–≤–µ–Ω—å: {profile.grade_target}")
    print(f"–û–ø—ã—Ç: {profile.experience}")
    print("=" * 70)
    
    output_path = f"logs/advanced_test_{name.lower().replace(' ', '_')}.json"
    
    try:
        session = run_scripted_interview(
            profile=profile,
            messages=messages,
            output_path=output_path,
            verbose=True
        )
        
        print("\n" + "=" * 70)
        print("‚úÖ –¢–ï–°–¢ –ó–ê–í–ï–†–®–Å–ù")
        print("=" * 70)
        print(f"\nüìÑ –õ–æ–≥ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤: {output_path}")
        
        return session
        
    except Exception as e:
        print(f"\n‚ùå –û–®–ò–ë–ö–ê: {e}")
        import traceback
        traceback.print_exc()
        return None


# Mapping of scenario names to their data
SCENARIOS = {
    "contradiction": (CONTRADICTION_PROFILE, CONTRADICTION_SCENARIO, "–ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ"),
    "nested": (NESTED_CONTEXT_PROFILE, NESTED_CONTEXT_SCENARIO, "Nested Context"),
    "initiative": (INITIATIVE_PROFILE, INITIATIVE_SCENARIO, "–ü–µ—Ä–µ—Ö–≤–∞—Ç –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã"),
    "fictional": (FICTIONAL_TECH_PROFILE, FICTIONAL_TECH_SCENARIO, "–í—ã–¥—É–º–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"),
    "stress": (STRESS_TEST_PROFILE, STRESS_TEST_SCENARIO, "–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç"),
    "emotional": (EMOTIONAL_PROFILE, EMOTIONAL_SCENARIO, "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ"),
}


def main():
    import argparse
    
    parser = argparse.ArgumentParser(
        description="Run advanced test scenarios for Interview Coach",
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog="""
Available scenarios:
  contradiction  - –ö–∞–Ω–¥–∏–¥–∞—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç —Å–≤–æ–∏–º —Ä–∞–Ω–Ω–∏–º –∑–∞—è–≤–ª–µ–Ω–∏—è–º
  nested        - –ì–ª—É–±–æ–∫–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è (nested context)
  initiative    - –ö–∞–Ω–¥–∏–¥–∞—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É
  fictional     - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—ã–º—ã—à–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
  stress        - –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç (–≤—Å—ë —Å—Ä–∞–∑—É)
  emotional     - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ –∏ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏
  all           - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
        """
    )
    parser.add_argument(
        "--scenario", "-s",
        choices=list(SCENARIOS.keys()) + ["all"],
        required=True,
        help="Which scenario to run"
    )
    
    args = parser.parse_args()
    
    if args.scenario == "all":
        results = {}
        for name, (profile, messages, display_name) in SCENARIOS.items():
            print(f"\n\n{'#' * 70}")
            print(f"# Running: {display_name}")
            print(f"{'#' * 70}\n")
            results[name] = run_scenario(profile, messages, display_name)
            print("\n" + "-" * 70 + "\n")
        
        print("\n\n" + "=" * 70)
        print("üìä –ò–¢–û–ì–ò –í–°–ï–• –¢–ï–°–¢–û–í")
        print("=" * 70)
        for name, result in results.items():
            status = "‚úÖ" if result else "‚ùå"
            print(f"  {status} {SCENARIOS[name][2]}")
    else:
        profile, messages, display_name = SCENARIOS[args.scenario]
        run_scenario(profile, messages, display_name)


if __name__ == "__main__":
    main()
